SELECT l.cars_id AS car_number, m.carmarka, m.carmodel, m.carclass, COUNT(l.cars_id) AS how_much_times FROM "Carrent".models m,  "Carrent".leaseagreement l, "Carrent".cars c WHERE l.cars_id = c.cars_id AND c.model_id = m.model_id AND m.carmarka IN ( SELECT m1.carmarka FROM "Carrent".models m1 , "Carrent".cars c1, "Carrent".leaseagreement l1 WHERE m1.model_id = c1.model_id AND c1.cars_id = l1.cars_id GROUP BY m1.carmarka ORDER BY  COUNT(m1.carmarka)  desc) GROUP BY m.carmarka, l.cars_id,m.carmodel, m.carclass ORDER BY COUNT(l.cars_id) desc